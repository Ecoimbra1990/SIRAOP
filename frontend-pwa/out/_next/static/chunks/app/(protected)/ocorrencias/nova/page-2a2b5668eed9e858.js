(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[905],{6142:function(e,a,t){"use strict";t.d(a,{Z:function(){return i}});var s=t(2898);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=(0,s.Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},3473:function(e,a,t){Promise.resolve().then(t.bind(t,2291))},2291:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return NovaOcorrenciaPage},dynamic:function(){return p}});var s=t(7437),i=t(2265),r=t(4033),l=t(1865),n=t(8110),o=t(2160),c=t(9843),d=t(6142);function SimpleMapPicker(e){let{latitude:a=-12.9714,longitude:t=-38.5014,onLocationSelect:r,height:l="400px"}=e,[n,o]=(0,i.useState)([a,t]),handleLocationSelect=(e,a)=>{o([e,a]),r(e,a)};return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,s.jsx)(d.Z,{className:"h-4 w-4"}),"Use os controles para definir a localiza\xe7\xe3o"]}),(0,s.jsx)("button",{type:"button",onClick:()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{let{latitude:a,longitude:t}=e.coords;o([a,t]),r(a,t)},e=>{console.error("Erro ao obter localiza\xe7\xe3o:",e),alert("Erro ao obter sua localiza\xe7\xe3o atual")}):alert("Geolocaliza\xe7\xe3o n\xe3o \xe9 suportada por este navegador")},className:"btn-outline text-xs px-3 py-1",children:"Minha Localiza\xe7\xe3o"})]}),(0,s.jsx)("div",{className:"border rounded-lg overflow-hidden bg-gray-100",style:{height:l},children:(0,s.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(d.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:"Mapa interativo ser\xe1 carregado aqui"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium",children:"Latitude:"}),(0,s.jsx)("input",{type:"number",value:n[0],onChange:e=>{let a=parseFloat(e.target.value);isNaN(a)||handleLocationSelect(a,n[1])},className:"input text-sm w-32",step:"0.000001"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium",children:"Longitude:"}),(0,s.jsx)("input",{type:"number",value:n[1],onChange:e=>{let a=parseFloat(e.target.value);isNaN(a)||handleLocationSelect(n[0],a)},className:"input text-sm w-32",step:"0.000001"})]})]})]})})}),(0,s.jsxs)("div",{className:"text-sm text-gray-500",children:["Latitude: ",n[0].toFixed(6)," | Longitude: ",n[1].toFixed(6)]})]})}var x=t(2898);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let m=(0,x.Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),u=(0,x.Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),p="force-dynamic",h=o.Ry({tipo:o.Z_().min(1,"Tipo \xe9 obrigat\xf3rio"),data_hora_fato:o.Z_().min(1,"Data e hora do fato s\xe3o obrigat\xf3rias"),descricao:o.Z_().min(10,"Descri\xe7\xe3o deve ter pelo menos 10 caracteres"),endereco:o.Z_().min(1,"Endere\xe7o \xe9 obrigat\xf3rio"),bairro:o.Z_().optional(),cidade:o.Z_().optional(),estado:o.Z_().optional(),cep:o.Z_().optional(),opm:o.Z_().optional(),numero_bo:o.Z_().optional(),delegacia:o.Z_().optional(),status:o.Z_().optional(),observacoes:o.Z_().optional()});function NovaOcorrenciaPage(){let[e,a]=(0,i.useState)(-12.9714),[t,o]=(0,i.useState)(-38.5014),[x,p]=(0,i.useState)(!1),[j,v]=(0,i.useState)(""),b=(0,r.useRouter)(),{register:g,handleSubmit:N,formState:{errors:f},setValue:y,watch:k}=(0,l.cI)({resolver:(0,n.F)(h),defaultValues:{status:"ativa",cidade:"Salvador",estado:"BA"}}),onSubmit=async a=>{try{p(!0),v("");let s={...a,latitude:e,longitude:t};await c.vh.create(s),b.push("/dashboard")}catch(e){var s,i;v((null===(i=e.response)||void 0===i?void 0:null===(s=i.data)||void 0===s?void 0:s.message)||"Erro ao criar ocorr\xeancia")}finally{p(!1)}};return(0,s.jsxs)("div",{className:"container mx-auto px-4 py-6",children:[(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,s.jsxs)("button",{onClick:()=>b.back(),className:"btn-outline flex items-center gap-2",children:[(0,s.jsx)(m,{className:"h-4 w-4"}),"Voltar"]}),(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Nova Ocorr\xeancia"})]})}),(0,s.jsxs)("form",{onSubmit:N(onSubmit),className:"space-y-6",children:[j&&(0,s.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:j}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"card",children:[(0,s.jsx)("div",{className:"card-header",children:(0,s.jsx)("h2",{className:"card-title",children:"Informa\xe7\xf5es B\xe1sicas"})}),(0,s.jsxs)("div",{className:"card-content space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tipo de Ocorr\xeancia *"}),(0,s.jsxs)("select",{...g("tipo"),className:"input",children:[(0,s.jsx)("option",{value:"",children:"Selecione o tipo"}),(0,s.jsx)("option",{value:"Homic\xeddio",children:"Homic\xeddio"}),(0,s.jsx)("option",{value:"Roubo",children:"Roubo"}),(0,s.jsx)("option",{value:"Furto",children:"Furto"}),(0,s.jsx)("option",{value:"Tr\xe1fico",children:"Tr\xe1fico de Drogas"}),(0,s.jsx)("option",{value:"Assalto",children:"Assalto"}),(0,s.jsx)("option",{value:"Vandalismo",children:"Vandalismo"}),(0,s.jsx)("option",{value:"Outros",children:"Outros"})]}),f.tipo&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:f.tipo.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data e Hora do Fato *"}),(0,s.jsx)("input",{...g("data_hora_fato"),type:"datetime-local",className:"input"}),f.data_hora_fato&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:f.data_hora_fato.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Descri\xe7\xe3o *"}),(0,s.jsx)("textarea",{...g("descricao"),rows:4,className:"input",placeholder:"Descreva detalhadamente o que aconteceu..."}),f.descricao&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:f.descricao.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),(0,s.jsxs)("select",{...g("status"),className:"input",children:[(0,s.jsx)("option",{value:"ativa",children:"Ativa"}),(0,s.jsx)("option",{value:"arquivada",children:"Arquivada"}),(0,s.jsx)("option",{value:"resolvida",children:"Resolvida"})]})]})]})]}),(0,s.jsxs)("div",{className:"card",children:[(0,s.jsx)("div",{className:"card-header",children:(0,s.jsxs)("h2",{className:"card-title flex items-center gap-2",children:[(0,s.jsx)(d.Z,{className:"h-5 w-5"}),"Localiza\xe7\xe3o"]})}),(0,s.jsxs)("div",{className:"card-content space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Endere\xe7o *"}),(0,s.jsx)("input",{...g("endereco"),type:"text",className:"input",placeholder:"Rua, n\xfamero, complemento..."}),f.endereco&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:f.endereco.message})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bairro"}),(0,s.jsx)("input",{...g("bairro"),type:"text",className:"input"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"CEP"}),(0,s.jsx)("input",{...g("cep"),type:"text",className:"input",placeholder:"00000-000"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cidade"}),(0,s.jsx)("input",{...g("cidade"),type:"text",className:"input"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Estado"}),(0,s.jsx)("input",{...g("estado"),type:"text",className:"input",maxLength:2})]})]})]})]})]}),(0,s.jsxs)("div",{className:"card",children:[(0,s.jsxs)("div",{className:"card-header",children:[(0,s.jsx)("h2",{className:"card-title",children:"Localiza\xe7\xe3o no Mapa"}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Clique no mapa para definir a localiza\xe7\xe3o exata da ocorr\xeancia"})]}),(0,s.jsx)("div",{className:"card-content",children:(0,s.jsx)(SimpleMapPicker,{latitude:e,longitude:t,onLocationSelect:(e,t)=>{a(e),o(t)}})})]}),(0,s.jsxs)("div",{className:"card",children:[(0,s.jsx)("div",{className:"card-header",children:(0,s.jsx)("h2",{className:"card-title",children:"Informa\xe7\xf5es Adicionais"})}),(0,s.jsxs)("div",{className:"card-content space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"OPM (\xd3rg\xe3o Policial Militar)"}),(0,s.jsx)("input",{...g("opm"),type:"text",className:"input"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"N\xfamero do BO"}),(0,s.jsx)("input",{...g("numero_bo"),type:"text",className:"input"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Delegacia"}),(0,s.jsx)("input",{...g("delegacia"),type:"text",className:"input"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Observa\xe7\xf5es"}),(0,s.jsx)("textarea",{...g("observacoes"),rows:3,className:"input",placeholder:"Informa\xe7\xf5es adicionais relevantes..."})]})]})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,s.jsx)("button",{type:"button",onClick:()=>b.back(),className:"btn-outline",children:"Cancelar"}),(0,s.jsxs)("button",{type:"submit",disabled:x,className:"btn-primary flex items-center gap-2",children:[(0,s.jsx)(u,{className:"h-4 w-4"}),x?"Salvando...":"Salvar Ocorr\xeancia"]})]})]})]})}},9843:function(e,a,t){"use strict";t.d(a,{BV:function(){return d},iJ:function(){return o},vh:function(){return c}});var s=t(4829),i=t(7179),r=t(5566);let l=r.env.NEXT_PUBLIC_API_URL||"http://localhost:8080/api",n=s.Z.create({baseURL:l,headers:{"Content-Type":"application/json"}});n.interceptors.request.use(e=>{let a=i.L.getState().token;return a&&(e.headers.Authorization="Bearer ".concat(a)),e},e=>Promise.reject(e)),n.interceptors.response.use(e=>e,e=>{var a;return(null===(a=e.response)||void 0===a?void 0:a.status)===401&&(i.L.getState().logout(),window.location.href="/login"),Promise.reject(e)});let o={login:async(e,a)=>{let t=await n.post("/auth/login",{email:e,password:a});return t.data},register:async e=>{let a=await n.post("/auth/register",e);return a.data}},c={getAll:async()=>{let e=await n.get("/ocorrencias");return e.data},getById:async e=>{let a=await n.get("/ocorrencias/".concat(e));return a.data},create:async e=>{let a=await n.post("/ocorrencias",e);return a.data},update:async(e,a)=>{let t=await n.patch("/ocorrencias/".concat(e),a);return t.data},delete:async e=>{let a=await n.delete("/ocorrencias/".concat(e));return a.data},findNearby:async(e,a,t)=>{let s=await n.get("/ocorrencias/nearby",{params:{lat:e,lng:a,radius:t}});return s.data}},d={gerarInformativoPDF:async e=>{let a=await n.post("/relatorios/informativo-pdf",{ocorrenciaIds:e},{responseType:"blob"}),t=window.URL.createObjectURL(new Blob([a.data])),s=document.createElement("a");return s.href=t,s.setAttribute("download","informativo_".concat(Date.now(),".pdf")),document.body.appendChild(s),s.click(),s.remove(),window.URL.revokeObjectURL(t),a.data}}},7179:function(e,a,t){"use strict";t.d(a,{L:function(){return r}});var s=t(4660),i=t(4810);let r=(0,s.Ue)()((0,i.tJ)(e=>({user:null,token:null,isAuthenticated:!1,isLoading:!1,login:(a,t)=>{e({user:a,token:t,isAuthenticated:!0,isLoading:!1})},logout:()=>{e({user:null,token:null,isAuthenticated:!1,isLoading:!1})},setLoading:a=>{e({isLoading:a})}}),{name:"siraop-auth-storage",partialize:e=>({user:e.user,token:e.token,isAuthenticated:e.isAuthenticated})}))}},function(e){e.O(0,[811,829,727,971,472,744],function(){return e(e.s=3473)}),_N_E=e.O()}]);